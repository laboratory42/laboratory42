<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laboratory 42</title>

    <!-- <link rel="icon" type="image/svg+xml" href="/resources/favicon.svg" /> -->
    <link rel="alternate icon" href="favicon.ico" />
    <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ff8a01" /> -->

    <link rel="stylesheet" href="./_rsrc/css/reset.css" />

    <link rel="stylesheet" href="./_app/ui/app.css" />


</head>
<body>

<h1>Laboratory 42</h1>
<h3>fetched partials and json data</h3>



<main>

<header>
    <nav id="navigation">
    </nav>
</header>

<section id="content">
</section>

<footer id="footer">
</footer>

</main>




<div id="debug">

</div>






<!-- Lab 42 stuff -->
<script src="./_rsrc/start.js"></script>
<script src="./_rsrc/library/payload.js"></script>

<!-- app startup script -->
<script defer src="./_app/start_app.js"></script>



<ul class="navbar-list">
    <li class="navbar-item">
      <a href="#" onclick="onNavClick('/home'); return false;">home</a>
    </li>
    <li class="navbar-item">
      <a href="#" onclick="onNavClick('/work'); return false;">work</a>
    </li>
    <li class="navbar-item">
      <a href="#" onclick="onNavClick('/hire'); return false;">hire</a>
    </li>
</ul>



<div id="root"></div>
<script>
    //Get the Element with the Id 'root'
const rootDiv = document.getElementById('root');

//Declare the variables for home, about & contact html pages
let home = '';
let work = '';
let hire = '';

/**
 *
 * @param {String} page - Represents the page information that needs to be retrieved
 * @returns {String} resHtml - The Page's HTML is returned from the async invocation
 */

const loadPage = async (page) => {
  const response = await fetch(page);
  const resHtml = await response.text();
  return resHtml;
};

/**
 * The Async function loads all HTML to the variables 'home', 'about' & 'contact'
 */
const loadAllPages = async () => {
    home = await loadPage('_app/partials/home.html');
    work = await loadPage('_app/partials/work.html');
    hire = await loadPage('_app/partials/hire.html');
};

/**
 * The Main Function is an async function that first loads All Page HTML to the variables
 * Once the variables are loaded with the contents, then they are assigned to the 'routes' variable
 */
const main = async () => {
  await loadAllPages();
  rootDiv.innerHTML = home;
  routes = {
    '/home': home,
    '/work': work,
    '/hire': hire,
  };
};

// Invoke the Main function
main();

/**
 *
 * @param {String} pathname - Pass the 'pathname' passed from onClick function of the link (index.html)
 * The function is invoked when any link is clicked in the html.
 * The onClick event on the html invokes the onNavClick & passes the pathname as param
 */
const onNavClick = (pathname) => {
    window.history.pushState({}, pathname, window.location.origin + pathname);
    rootDiv.innerHTML = routes[pathname];
};

/**
 * The Function is invoked when the window.history's state changes
 */
window.onpopstate = () => {
    rootDiv.innerHTML = routes[window.location.pathname];
};


</script>

</body>
</html>
