!function t(e,n,r){function i(a,f){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!f&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return i(n||t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i={_config:{},_events:{},_state:null,_defaultConfig:{filterHtml:!0,containerAttr:"data-pfetch",defaultContainer:"body"},on:function(t,e){this._events[t]=e},run:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._loadConfig(t),this._registerEvents(document),window.onpopstate=this._handlePopState.bind(this),this._state||(this._state={url:window.location.href,title:document.title,fragment:document.body.innerHTML,container:"body"},window.history.replaceState(this._state,document.title))},_createHtmlElement:function(t){var e=document.createElement("html");return e.innerHTML=t,e},_fire:function(t,e){var n=this._events[t];n&&n.apply(void 0,r(e))},_getContainer:function(t){var e=t.getAttribute(this._config.containerAttr);return e||(e=this._config.defaultContainer),e},_getFragment:function(t,e){if(this._config.filterHtml){var n=t.querySelector(e);return n||t}return t},_getTitle:function(t){var e=t.getElementsByTagName("title")[0];return e?e.innerText:document.title},_handleClick:function(t){var e=this;t.preventDefault();var n=t.target.closest("a"),r=n.href,i={method:"GET",headers:{"Content-Type":"text/html"}};this._fire("beforeFetch",[i]),"GET"!=i.method&&"HEAD"!=i.method||delete i.body,fetch(r,i).then(function(t){return e._fire("afterFetch",[t]),-1==t.headers.get("Content-Type").indexOf("text/html")?null:t.text()}).then(function(t){if(t){var i=e._getContainer(n),o=e._createHtmlElement(t),a=e._getTitle(o),f=e._getFragment(o,i);e._fire("beforeReplace",[f]),e._replaceContent(i,a,f.innerHTML),e._fire("afterReplace",[f]),e._state={url:r,title:a,fragment:document.body.innerHTML,container:"body"},window.history.pushState(e._state,a,r)}})},_handlePopState:function(t){var e=t.state;this._replaceContent(e.container,e.title,e.fragment)},_loadConfig:function(t){for(var e=Object.keys(t),n=this._defaultConfig,r=0;r<e.length;r++){var i=t[e[r]];e[r]in n&&(n[e[r]]=i)}this._config=n},_registerEvents:function(t){for(var e="a["+this._config.containerAttr+"]",n=t.querySelectorAll(e),r=0;r<n.length;r++)n[r].addEventListener("click",this._handleClick.bind(this))},_replaceContent:function(t,e,n){var r=document.querySelector(t);document.title=e,r.innerHTML=n,this._registerEvents(r)}};window.pfetch=i},{}]},{},[1]);
